<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/" />
<title>Assignment 1: Pumping Circuits</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="assignment-1-pumping-circuits">
<h1 class="title">Assignment 1: Pumping Circuits</h1>

<!-- Copyright 2020, Oskar T. Inderberg -->
<p>Pumping circuits is a program which provides design, troubleshooting and analysis of fluid circuits.</p>
<div class="section" id="getting-started">
<h1>Getting Started</h1>
<p>This Python program requires at least python 3.5.</p>
<div class="section" id="features">
<h2>Features</h2>
<ul class="simple">
<li><dl class="first docutils">
<dt>Circuit design with the following parts:</dt>
<dd><ul class="first last">
<li>Tanks</li>
<li>Pipes</li>
<li>Bends</li>
<li>Pumps</li>
<li>Valves</li>
<li>Filters</li>
</ul>
</dd>
</dl>
</li>
<li>Calculate the energy consumption for these circuits</li>
<li>HTML study generation with adaptability for different use cases</li>
<li>Validate circuits validity in a 2D-plane</li>
<li>Testing with near 100% line coverage</li>
</ul>
</div>
<div class="section" id="assumptions">
<h2>Assumptions</h2>
<ul class="simple">
<li>Pipes can have a length of no shorter than 1 m. To change this change set function for PipeStraight.</li>
<li>While the program requires pipes with the angles 0 and 90,
it is possible to adapt for pipes with angles between with some adaptations.</li>
</ul>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<p>This project comes with a <em>main.py</em> file which is the base for running the deployed system. From here one can set
parameters as one want. For analysis of existing circuits import files into the data folder and load them.</p>
<pre class="code bash literal-block">
$ pip install -r requirements.txt
$ python main.py
</pre>
</div>
</div>
<div class="section" id="pumping-circuits">
<h1>Pumping Circuits</h1>
<p>This program tries to conform to several &quot;good practises&quot; following the following principles:</p>
<blockquote>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it">YAGNI</a></p>
<dl class="docutils">
<dt>The Zen of Python</dt>
<dd><pre class="first last doctest-block">
&gt;&gt;&gt; import this
</pre>
</dd>
</dl>
</blockquote>
<p>Because these where applied some time into the development of this program, and the resource cost of
refactoring one might find parts that do not adhere to these principles.</p>
<div class="section" id="general-conventions">
<h2>General conventions</h2>
<p>Most classes are initialized with a init function. This takes in arguments and initializes a object, assigning
member variables with their given value. Private member variables are named with the following convention
<tt class="docutils literal">_variable_name</tt>, public variables are named without the leading underscore <tt class="docutils literal">variable_name</tt>. Private and public
member functions also follow this convention.</p>
<p>Classes in this project use <a class="reference external" href="https://docs.python.org/3/library/functions.html?highlight=property#property">properties</a>
as opposed to setter and getter functions. Properties function as setter and getter functions, but are accessed with
<tt class="docutils literal">some_object.property_name</tt> in the same way manipulating private member variables without accessing them directly.</p>
<p>Some classes have representations defined using the magic methods <tt class="docutils literal">__repr__</tt> or <tt class="docutils literal">__str__</tt>. These are mostly used
for printing classes, but are also useful in debugging.</p>
<p>The classes Circuit and FileHandler can be used as
<a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#context-managers">context managers</a> in which a certain context is
created when using the with statement. See the docstrings for the __enter__ methods explain their uses.</p>
<p>&#64;typechecked a decorator from the package <tt class="docutils literal">pytypes</tt>, which checks that the arguments in functions follow the
annotations.</p>
<p>Trailing underscores are used when naming conflicts with pythons built in functions.</p>
</div>
<div class="section" id="file-specifics">
<h2>File specifics</h2>
<div class="section" id="main-py">
<h3>main.py</h3>
<p>This is the file to be run by regular users for analysing circuits. It is run by using one of its two functions. One is
run purely by user input the other is run by editing the function and running it in main.</p>
<p>Custom ranges and velocities
can be set here as well. By altering the default function one can input custom ranges if specific velocity studies need
to be calculated. In addition one can set ranges for the plot-studies if the ranges dont fit the desired purpose.</p>
<p>For example:</p>
<pre class="code python literal-block">
<span class="name">page_generator</span><span class="operator">.</span><span class="name">default_page_generation</span><span class="punctuation">(</span><span class="name">circuit</span><span class="punctuation">,</span> <span class="name">base_velocity</span><span class="operator">=</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="name">height_range</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">100</span><span class="punctuation">,</span> <span class="literal number integer">90</span><span class="punctuation">),</span>
                                                   <span class="name">efficiency_range</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number float">0.1</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">90</span><span class="punctuation">),</span> <span class="name">velocity_range</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">),</span>
                                                   <span class="name">diameter_range</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number float">0.1</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">))</span>
</pre>
<p>Remember, pipes have a minimum length of 1 m. This means that the height range cant be lower than the amount of
vertical pipes. <tt class="docutils literal">velocity_range</tt> works is a regular for loop range, the others have a different step type. The last
argument is the amount of steps and not the step size. <tt class="docutils literal">base_velocity</tt> is used for calculating the core attributes.</p>
<p>This method can also be used for <tt class="docutils literal">page_generator.export_circuit_study_in_HTML()</tt> as they accept those same arguments.</p>
</div>
<div class="section" id="parts-py">
<h3>parts.py</h3>
<p>This module contains the parts of the circuit. The class <tt class="docutils literal">Part</tt> is abstract class for all other parts used. It
contains a name which is a property shared by all parts, accessed with <tt class="docutils literal">Part.name</tt>.</p>
<p>It also contains two different
<a class="reference external" href="https://en.wikipedia.org/wiki/Factory_(object-oriented_programming)">factory methods</a>, which use arguments or
keyword arguments to initialize and return objects.</p>
<dl class="docutils">
<dt>All sub part classes are structured with the following pattern:</dt>
<dd><ol class="first last arabic simple">
<li><dl class="first docutils">
<dt>Initialization</dt>
<dd><ul class="first last">
<li>Initializing private member variables</li>
</ul>
</dd>
</dl>
</li>
<li>Representation</li>
<li>Properties</li>
<li>Factory functions</li>
<li>Calculation functions</li>
</ol>
</dd>
</dl>
<p>Factory functions are used by the factory methods to instance new objects which have different arguments than the
initializer.</p>
<p>Calculation functions are functions used by the class <tt class="docutils literal">CircuitCalculator</tt> to calculate losses of pressure or
return the objects specific zeta value. While it would be preferred to contain these functions in the class
<tt class="docutils literal">CircuitCalculator</tt> it was simpler to add it to the parts for easy iteration.</p>
</div>
<div class="section" id="circuit-py">
<h3>circuit.py</h3>
<p>Overall class representing a circuit. <tt class="docutils literal">canvas</tt> is its central variable. This contains a chronological list of
parts. Items in the canvas can be accessed through <tt class="docutils literal">some_circuit[index]</tt>.</p>
<p>Circuit can, as previously mentioned, be used in a context where one can alter it and then it reverts back when leaving
the context. This is useful in <em>study_.py</em> because here we want to alter a circuit do some studies and then return
the original for final alterations.</p>
<p>Some of a circuits properties are independent of the amount of parts in it. Such properties are efficiency and inside
diameter. They can therefore be defined for the entire circuit. Additionally their setters must alter parts in the
circuit in order to represent the circuit correctly.</p>
<p>The latter half of this file contains a function and a class used to generate new Circuits with user input, but it
ended up becoming legacy code as it was not very effective and demanded a lot of changes after refactoring the circuit
class. I do want to include it as it is not far from usable and with more time it would be a useful feature for such a
program.</p>
</div>
<div class="section" id="parser-py">
<h3>parser.py</h3>
<p>This file contains parser class which can be used for parsing different file types. It should be used by calling
its member function <tt class="docutils literal">parse</tt> which uses <em>file_handler.py</em> and <em>path_finder.py</em> as well as the package ElementTree to
parse tsv, csv and xml formats.</p>
</div>
<div class="section" id="circuit-control-py">
<h3>circuit_control.py</h3>
<p>This file contains the <tt class="docutils literal">CircuitControl</tt> class which is used to control circuits for faults. It is used by initializing
a class instance and then called with the function <tt class="docutils literal">control_circuit</tt> which takes in a circuit and raises an exception
if a rule is broken. If no rule is broken it returns <tt class="docutils literal">True</tt>.</p>
</div>
<div class="section" id="circuit-calculator-py">
<h3>circuit_calculator.py</h3>
<p>This file holds two classes. The first <tt class="docutils literal">CircuitFormulas</tt> contains all the formulas used for the different calculations
used on a circuit. The second <tt class="docutils literal">CircuitCalculator</tt> is the class used for retrieving the different calculations.
Modularizing the functions in such a way makes it easy to alter functions if needed and the calculator class remains
readable. One might want to change the function names in <tt class="docutils literal">CircuitFormulas</tt> to make it more simple and flat.</p>
<p>The class <tt class="docutils literal">CircuitFormulas</tt> contains a warning if the reynolds number exceeds 10^5. Remove the first if statement in
<tt class="docutils literal">calculate_flow_coefficient()</tt> to remove the warning.</p>
</div>
<div class="section" id="study-py">
<h3>study_.py</h3>
<p>This file holds the class <tt class="docutils literal">Study</tt> which, after initialized, can be called with a study function. This class takes
one argument and has one property, velocity. A study function
utilizes the classes private functions to perform some studies on a circuit. A circuit should be designed and controlled
before using these functions. If one is to create new studies they should be created as public member functions to be
called from this class.</p>
</div>
<div class="section" id="page-generator-py">
<h3>page_generator.py</h3>
<p>This file is used for generating HTML reports for studies of circuits. It holds two classes, <tt class="docutils literal">HTMLSerializer</tt> and
<tt class="docutils literal">HTMLPageGenerator</tt>. The first holds functions required for the latter. The latter is used in by main to generate a
HTML study file which represents the circuit. It has two public functions which can be used, either with custom circuits
or with the default circuit, which is <em>circuit.tsv</em> in <em>templates</em>. To simplify all HTML files and sources are in the
same folder: <em>templates</em>.</p>
</div>
</div>
<div class="section" id="testing">
<h2>Testing</h2>
<p>As testing and quality control of existing code is a important part of managing code, this program is developed with
the standard package unittest for testing. This gives the developer to easily and continuously test all parts of the
code concurrently with development.</p>
<p>To use this feature one has to:</p>
<pre class="code bash literal-block">
$ <span class="name builtin">cd</span> /path/to/project-dir/
$ python -m unittest
</pre>
<p>Testing during this projects development is done using, as mentioned earlier, the packages <strong>unittest</strong> as well as
<strong>coverage</strong>. Coverages gives the developer an overview of what lines of code has been run. The tests developed have
tried to provide 100% line coverage to ensure that all lines have been tested and gives the expected response.</p>
<p>Testing has also been done with coverage, and a report has been generated showing what lines have been tested and which
have not been tested with the current method. All necessary tests have been run, but are not included in tests.</p>
</div>
<div class="section" id="modularisation">
<h2>Modularisation</h2>
<p>As this python program is composed of several modules and data sets it is departmentalized into different folders.
Reviewing the project structure, it is composed of the folders data, tests and module, as well as a top facing
main function. Basing the project such provides a clear overview and modularize's the project into easy accessible
files without overwhelming the user.</p>
<p>This is an attempt to create files which can be copied and pasted to new projects when needed. For example
<em>file_handler.py</em> and <em>parser.py</em> are meant to be easily adapted for new projects. Furthermore modularizing classes
which dont share inheritance seemed like a useful standard.</p>
<!-- Compared to many other projects this project is modularized in quite a degree. -->
</div>
<div class="section" id="documentation-docstrings-and-annotations">
<h2>Documentation, docstrings and annotations</h2>
<p>In an attempt to develop this project in a more realistic manner, close to a real world open-source project I have
tried to use the conventions of creating a README and use <a class="reference external" href="https://www.python.org/dev/peps/pep-0257/">docstrings</a>
and <a class="reference external" href="https://www.python.org/dev/peps/pep-3107/">annotations</a>.</p>
<p>These have been used to give new developers an idea of what a function takes in and outputs. Using with an IDE which
supports docstrings helps developers in a great deal when sorting through use of the code.</p>
<p>Discovering these conventions during development has led to some inconsistencies in the project.</p>
<div class="section" id="afterthoughts">
<h3>Afterthoughts</h3>
<p>I should have decided on some conventions in the start of the project and kept to them. Refactoring and changing
conventions midway was very time consuming and with led to a lot of issues.</p>
<p>Consistency is key. When working on big projects, if one does not keep to decided standards it makes it hard to alter
code after not using it for some time. In my case after reading about properties and factory functions, it may have
saved me a lot of time not to adapt them until the next project.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Oskar T. Inderberg</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">1.0</td>
</tr>
<tr class="field"><th class="field-name">GitHub:</th><td class="field-body"><a class="reference external" href="https://github.com/Iskers/Assignment_1-Circuits">https://github.com/Iskers/Assignment_1-Circuits</a></td>
</tr>
<tr class="field"><th class="field-name">Date created:</th><td class="field-body">03.02.2020</td>
</tr>
<tr class="field"><th class="field-name">Last updated:</th><td class="field-body">08.03.2020</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</body>
</html>
